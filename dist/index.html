<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AoE IV and AoM RNG</title>
  <style>
    :root {
      --primary-color: #3498db;
      --secondary-color: #2c3e50;
      --background-color: #ecf0f1;
      --text-color: #34495e;
      --border-color: #bdc3c7;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: var(--text-color);
      background-color: var(--background-color);
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }

    h1 {
      color: var(--secondary-color);
      text-align: center;
      margin-bottom: 30px;
      font-size: 2.5em;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.3s ease;
      border-radius: 5px;
      display: block;
      margin: 0 auto 30px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    button:hover {
      background-color: #2980b9;
      transform: translateY(-2px);
      box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    #result {
      background-color: white;
      border: 1px solid var(--border-color);
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }

    #result:hover {
      box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    #result h2 {
      color: var(--primary-color);
      margin-top: 0;
      font-size: 1.8em;
      border-bottom: 2px solid var(--primary-color);
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    #result h3 {
      color: var(--secondary-color);
      font-size: 1.4em;
      margin-bottom: 15px;
    }

    #result ul {
      list-style-type: none;
      padding: 0;
    }

    #result li {
      margin-bottom: 10px;
      padding: 10px;
      background-color: #f7f9fa;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    #result li:hover {
      background-color: #edf2f7;
    }

    .weight-inputs {
      margin-bottom: 20px;
    }

    .weight-inputs div {
      margin-bottom: 10px;
    }

    input[type="number"] {
      width: 60px;
    }
  </style>
</head>

<body>
  <h1>AoE IV and AoM RNG</h1>
  <button id="generateAoE4Btn">Generate AoE IV Civilization</button>
  <button id="generateAoMBtn">Generate AoM Major God</button>
  <div id="weights"></div>
  <button id="finalizeBtn" style="display:none;">Finalize Selection</button>
  <div id="result"></div>

  <script>
    const aoe4Civilizations = [
      "Abbasid Dynasty", "Ayyubids", "Byzantines", "Chinese", "Delhi Sultanate",
      "English", "French", "Holy Roman Empire", "Japanese", "Jeanne d'Arc",
      "Malians", "Mongols", "Order of the Dragon", "Ottomans", "Rus",
      "Zhu Xi's Legacy"
    ];

    const aoe4AgeUpOptions = {
      "Abbasid Dynasty": ["Culture Wing", "Economic Wing", "Military Wing", "Trade Wing"],
      "Ayyubids": ["Culture Wing", "Economic Wing", "Military Wing", "Trade Wing"],
      "Byzantines": {
        "II": ["Grand Winery", "Imperial Hippodrome"],
        "III": ["Golden Horn Tower", "Cistern of the First Hill"],
        "IV": ["Foreign Engineering Company", "Palatine School"]
      },
      "Chinese": {
        "II": ["Barbican of the Sun", "Imperial Academy"],
        "III": ["Imperial Palace", "Astronomical Clocktower"],
        "IV": ["Great Wall Gatehouse", "Spirit Way"]
      },
      "Delhi Sultanate": {
        "II": ["Tower of Victory", "Dome of the Faith"],
        "III": ["Compound of the Defender", "House of Learning"],
        "IV": ["Hisar Academy", "Palace of the Sultan"]
      },
      "English": {
        "II": ["Council Hall", "Abbey of Kings"],
        "III": ["King's Palace", "The White Tower"],
        "IV": ["Berkshire Palace", "Wynguard Palace"]
      },
      "French": {
        "II": ["Chamber of Commerce", "School of Cavalry"],
        "III": ["Royal Institute", "Guild Hall"],
        "IV": ["Red Palace", "College of Artillery"]
      },
      "Holy Roman Empire": {
        "II": ["Meinwerk Palace", "Aachen Chapel"],
        "III": ["Regnitz Cathedral", "Burgrave Palace"],
        "IV": ["Elzbach Palace", "Palace of Swabia"]
      },
      "Japanese": {
        "II": ["Koka Township", "Kura Storehouse"],
        "III": ["Floating Gate", "Temple of Equality"],
        "IV": ["Castle of the Crow", "Tanegashima Gunsmith"]
      },
      "Jeanne d'Arc": {
        "II": ["Chamber of Commerce", "School of Cavalry"],
        "III": ["Royal Institute", "Guild Hall"],
        "IV": ["Red Palace", "College of Artillery"]
      },
      "Malians": {
        "II": ["Saharan Trade Network", "Mansa Quarry"],
        "III": ["Grand Fulani Corral", "Farimba Garrison"],
        "IV": ["Griot Bara", "Fort of the Huntress"]
      },
      "Mongols": {
        "II": ["Deer Stones", "The Silver Tree"],
        "III": ["Kurultai", "Steppe Redoubt"],
        "IV": ["The White Stupa", "Khaganate Palace"]
      },
      "Order of the Dragon": {
        "II": ["Meinwerk Palace", "Aachen Chapel"],
        "III": ["Regnitz Cathedral", "Burgrave Palace"],
        "IV": ["Elzbach Palace", "Palace of Swabia"]
      },
      "Ottomans": {
        "II": ["Twin Minaret Medrese", "Sultanhani Trade Network"],
        "III": ["Istanbul Imperial Palace", "Mehmed Imperial Armory"],
        "IV": ["Istanbul Observatory", "Sea Gate Castle"]
      },
      "Rus": {
        "II": ["Kremlin", "The Golden Gate"],
        "III": ["High Trade House", "Abbey of the Trinity"],
        "IV": ["Spasskaya Tower", "High Armory"]
      },
      "Zhu Xi's Legacy": {
        "II": ["Meditation Gardens", "Jiangnan Tower"],
        "III": ["Mount Lu Academy", "Shaolin Monastery"],
        "IV": ["Zhu Xi's Library", "Temple of the Sun"]
      }
    };

    const aoe4AyyubidBonuses = {
      "Culture Wing": {
        "Advancement": {
          "II": "Age up takes 96s, costs 225 food, 125 gold",
          "III": "Age up takes 96s, costs 900 food, 500 gold",
          "IV": "Age up takes 96s, costs 1500 food, 750 gold"
        },
        "Logistics": {
          "II": "Grants 2 Dervishes, Dervish Mass Heal rate +25%",
          "III": "Grants 3 Dervishes, Dervish Mass Heal rate +30%",
          "IV": "Grants 4 Dervishes, Dervish Mass Heal rate +30% and permanent"
        }
      },
      "Economic Wing": {
        "Growth": {
          "II": "Grants 3 Villagers, Orchards +50 food",
          "III": "Grants 7 Villagers, Orchards +100 food",
          "IV": "Grants 10 Villagers, Villagers +10% work rate"
        },
        "Industry": {
          "II": "Grants 300 wood",
          "III": "Grants 1,000 wood",
          "IV": "Grants 2,500 wood"
        }
      },
      "Military Wing": {
        "Master Smiths": {
          "II": "Grants Feudal Age Blacksmith attack and armor technologies for free",
          "III": "Grants Castle Age Blacksmith attack and armor technologies for free (requires Feudal Age technologies)",
          "IV": "Grants Imperial Age Blacksmith attack and armor technologies for free (requires Castle Age technologies)"
        },
        "Reinforcement": {
          "II": "Grants 1 Desert Raider after 15 seconds, then 1 more every 2 minutes. Cavalry can construct siege",
          "III": "Grants 3 Desert Raiders after 15 seconds, then 3 more every 2 minutes. Cavalry can construct siege",
          "IV": "Grants 7 Desert Raiders after 15 seconds, then 7 more every 2 minutes. Cavalry can construct siege"
        }
      },
      "Trade Wing": {
        "Advisors": {
          "II": "Grants 3 Atabegs",
          "III": "Grants 5 Atabegs",
          "IV": "Grants 7 Atabegs"
        },
        "Bazaar": {
          "II": "Grants a trade caravan every 3 minutes",
          "III": "Grants a trade caravan with improved trades every 3 minutes",
          "IV": "Grants a trade caravan with further improved trades every 3 minutes"
        }
      }
    };

    const aomCivilizations = [
      "Greeks", "Egyptians", "Norse", "Atlanteans"
    ];

    const aomGods = {
      "Greeks": {
        "major": ["Zeus", "Poseidon", "Hades"],
        "minor": {
          "Zeus": {
            "Classical": ["Athena", "Hermes"],
            "Heroic": ["Apollo", "Dionysus"],
            "Mythic": ["Hera", "Hephaestus"]
          },
          "Poseidon": {
            "Classical": ["Ares", "Hermes"],
            "Heroic": ["Aphrodite", "Dionysus"],
            "Mythic": ["Artemis", "Hephaestus"]
          },
          "Hades": {
            "Classical": ["Ares", "Athena"],
            "Heroic": ["Aphrodite", "Apollo"],
            "Mythic": ["Artemis", "Hephaestus"]
          }
        }
      },
      "Egyptians": {
        "major": ["Ra", "Isis", "Set"],
        "minor": {
          "Ra": {
            "Classical": ["Bast", "Ptah"],
            "Heroic": ["Hathor", "Sekhmet"],
            "Mythic": ["Horus", "Osiris"]
          },
          "Isis": {
            "Classical": ["Anubis", "Bast"],
            "Heroic": ["Hathor", "Nephthys"],
            "Mythic": ["Osiris", "Thoth"]
          },
          "Set": {
            "Classical": ["Anubis", "Ptah"],
            "Heroic": ["Nephthys", "Sekhmet"],
            "Mythic": ["Horus", "Thoth"]
          }
        }
      },
      "Norse": {
        "major": ["Odin", "Thor", "Loki"],
        "minor": {
          "Odin": {
            "Classical": ["Freyja", "Forseti"],
            "Heroic": ["Njord", "Skadi"],
            "Mythic": ["Baldr", "Tyr"]
          },
          "Thor": {
            "Classical": ["Forseti", "Freyja"],
            "Heroic": ["Bragi", "Skadi"],
            "Mythic": ["Baldr", "Tyr"]
          },
          "Loki": {
            "Classical": ["Forseti", "Heimdall"],
            "Heroic": ["Bragi", "Njord"],
            "Mythic": ["Hel", "Tyr"]
          }
        }
      },
      "Atlanteans": {
        "major": ["Kronos", "Gaia", "Oranos"],
        "minor": {
          "Kronos": {
            "Classical": ["Prometheus", "Leto"],
            "Heroic": ["Hyperion", "Rheia"],
            "Mythic": ["Helios", "Atlas"]
          },
          "Gaia": {
            "Classical": ["Oceanus", "Leto"],
            "Heroic": ["Theia", "Rheia"],
            "Mythic": ["Atlas", "Hekate"]
          },
          "Oranos": {
            "Classical": ["Oceanus", "Prometheus"],
            "Heroic": ["Hyperion", "Theia"],
            "Mythic": ["Helios", "Hekate"]
          }
        }
      }
    };
    let currentAoE4Civ = null;
    let currentAoMCiv = null;

    function initializeWeights(civ, god = null) {
      if (civ in aoe4AgeUpOptions) {
        if (civ === "Abbasid Dynasty" || civ === "Ayyubids") {
          return {wings: [0.25, 0.25, 0.25, 0.25]};
        } else {
          return Object.fromEntries(
            Object.entries(aoe4AgeUpOptions[civ]).map(([age, options]) =>
              [age, Array.isArray(options) ? [0.5, 0.5] : null]
            )
          );
        }
      } else if (civ in aomGods && god) {
        return {
          "Classical": [0.5, 0.5],
          "Heroic": [0.5, 0.5],
          "Mythic": [0.5, 0.5]
        };
      }
      return {};
    }

    function updateWeight(key, index, value) {
      value = parseFloat(value);
      if (currentAoE4Civ) {
        if (currentAoE4Civ.name === "Abbasid Dynasty" || currentAoE4Civ.name === "Ayyubids") {
          const totalWeight = currentAoE4Civ.weights.wings.reduce((sum, w, i) => i !== index ? sum + w : sum, 0);
          currentAoE4Civ.weights.wings[index] = value;
          const scaleFactor = (1 - value) / totalWeight;
          currentAoE4Civ.weights.wings.forEach((w, i) => {
            if (i !== index) currentAoE4Civ.weights.wings[i] *= scaleFactor;
          });
        } else {
          currentAoE4Civ.weights[key][index] = value;
          currentAoE4Civ.weights[key][1 - index] = 1 - value;
        }
      } else if (currentAoMCiv) {
        currentAoMCiv.weights[key][index] = value;
        currentAoMCiv.weights[key][1 - index] = 1 - value;
      }
      updateWeightInputs();
    }

    function weightedRandomChoice(options, weights) {
      const totalWeight = weights.reduce((sum, weight) => sum + weight, 0);
      let random = Math.random() * totalWeight;
      for (let i = 0; i < options.length; i++) {
        if (random < weights[i]) {
          return options[i];
        }
        random -= weights[i];
      }
      return options[options.length - 1];
    }

    function generateRandomAoE4Civ() {
      const civ = aoe4Civilizations[Math.floor(Math.random() * aoe4Civilizations.length)];
      currentAoE4Civ = {name: civ, weights: initializeWeights(civ)};
      currentAoMCiv = null;
      updateWeightInputs();
      return currentAoE4Civ;
    }

    function generateRandomAoMCiv() {
      const civ = aomCivilizations[Math.floor(Math.random() * aomCivilizations.length)];
      const majorGod = aomGods[civ].major[Math.floor(Math.random() * aomGods[civ].major.length)];
      currentAoMCiv = {name: civ, god: majorGod, weights: initializeWeights(civ, majorGod)};
      currentAoE4Civ = null;
      updateWeightInputs();
      return currentAoMCiv;
    }

    function updateWeightInputs() {
      const weightsDiv = document.getElementById('weights');
      let html = '';

      if (currentAoE4Civ) {
        html += `<h3>Weights for ${currentAoE4Civ.name}:</h3>`;
        if (currentAoE4Civ.name === "Abbasid Dynasty" || currentAoE4Civ.name === "Ayyubids") {
          const wings = aoe4AgeUpOptions[currentAoE4Civ.name];
          wings.forEach((wing, index) => {
            html += `
          <div>
            ${wing} <input type="number" min="0" max="1" step="0.01" value="${currentAoE4Civ.weights.wings[index].toFixed(2)}" 
              onchange="updateWeight('wings', ${index}, this.value)">
          </div>
        `;
          });
        } else {
          for (const [age, options] of Object.entries(aoe4AgeUpOptions[currentAoE4Civ.name])) {
            if (Array.isArray(options)) {
              html += `
            <div>
              Age ${age}:
              ${options[0]} <input type="number" min="0" max="1" step="0.1" value="${currentAoE4Civ.weights[age][0].toFixed(1)}" 
                onchange="updateWeight('${age}', 0, this.value)">
              ${options[1]} <input type="number" min="0" max="1" step="0.1" value="${currentAoE4Civ.weights[age][1].toFixed(1)}" 
                onchange="updateWeight('${age}', 1, this.value)">
            </div>
          `;
            }
          }
        }
      } else if (currentAoMCiv) {
        html += `<h3>Weights for ${currentAoMCiv.name} - ${currentAoMCiv.god}:</h3>`;
        for (const age of ["Classical", "Heroic", "Mythic"]) {
          const options = aomGods[currentAoMCiv.name].minor[currentAoMCiv.god][age];
          html += `
        <div>
          ${age} Age:
          ${options[0]} <input type="number" min="0" max="1" step="0.1" value="${currentAoMCiv.weights[age][0].toFixed(1)}" 
            onchange="updateWeight('${age}', 0, this.value)">
          ${options[1]} <input type="number" min="0" max="1" step="0.1" value="${currentAoMCiv.weights[age][1].toFixed(1)}" 
            onchange="updateWeight('${age}', 1, this.value)">
        </div>
      `;
        }
      }

      weightsDiv.innerHTML = html;
    }

    function finalizeAoE4Selection() {
      if (!currentAoE4Civ) return;

      const ageUps = {};
      if (currentAoE4Civ.name === "Abbasid Dynasty" || currentAoE4Civ.name === "Ayyubids") {
        const wings = aoe4AgeUpOptions[currentAoE4Civ.name];
        const selectedWings = weightedRandomChoice(wings, currentAoE4Civ.weights.wings);
        if (currentAoE4Civ.name === "Abbasid Dynasty") {
          ageUps["II"] = selectedWings[0];
          ageUps["III"] = selectedWings[1];
          ageUps["IV"] = selectedWings.slice(2).join(" and ");
        } else { // Ayyubids
          for (const age of ["II", "III"]) {
            const wing = selectedWings.shift();
            const bonusTypes = Object.keys(aoe4AyyubidBonuses[wing]);
            const bonusType = bonusTypes[Math.floor(Math.random() * bonusTypes.length)];
            ageUps[age] = `${wing} - ${bonusType}: ${aoe4AyyubidBonuses[wing][bonusType][age]}`;
          }
          const imperialChoices = selectedWings.map(wing => {
            const bonusTypes = Object.keys(aoe4AyyubidBonuses[wing]);
            const bonusType = bonusTypes[Math.floor(Math.random() * bonusTypes.length)];
            return `${wing} - ${bonusType}: ${aoe4AyyubidBonuses[wing][bonusType]["IV"]}`;
          });
          ageUps["IV"] = imperialChoices.join(" and ");
        }
      } else {
        for (const [age, options] of Object.entries(aoe4AgeUpOptions[currentAoE4Civ.name])) {
          if (Array.isArray(options)) {
            ageUps[age] = weightedRandomChoice(options, currentAoE4Civ.weights[age]);
          }
        }
      }

      displayAoE4Result({civilization: currentAoE4Civ.name, ageUps});
    }

    function finalizeAoMSelection() {
      if (!currentAoMCiv) return;

      const minorGods = {};
      for (const age of ["Classical", "Heroic", "Mythic"]) {
        const options = aomGods[currentAoMCiv.name].minor[currentAoMCiv.god][age];
        minorGods[age] = weightedRandomChoice(options, currentAoMCiv.weights[age]);
      }

      displayAoMResult({civilization: currentAoMCiv.name, majorGod: currentAoMCiv.god, minorGods});
    }

    function displayAoE4Result(result) {
      const resultDiv = document.getElementById('result');
      let html = `<h2>AoE IV Random Civilization: ${result.civilization}</h2>`;
      html += '<h3>Age-up choices:</h3>';
      html += '<ul>';
      for (const [age, choice] of Object.entries(result.ageUps)) {
        html += `<li>Age ${age}: ${choice}</li>`;
      }
      html += '</ul>';
      resultDiv.innerHTML = html;
    }

    function displayAoMResult(result) {
      const resultDiv = document.getElementById('result');
      let html = `<h2>AoM Random Major God: ${result.civilization}</h2>`;
      html += `<h3>Major God: ${result.majorGod}</h3>`;
      html += '<h3>Minor Gods:</h3>';
      html += '<ul>';
      for (const [age, god] of Object.entries(result.minorGods)) {
        html += `<li>${age} Age: ${god}</li>`;
      }
      html += '</ul>';
      resultDiv.innerHTML = html;
    }

    document.getElementById('generateAoE4Btn').addEventListener('click', () => {
      const result = generateRandomAoE4Civ();
      document.getElementById('result').innerHTML = `<h2>Selected Civilization: ${result.name}</h2>`;
      document.getElementById('finalizeBtn').style.display = 'inline';
    });

    document.getElementById('generateAoMBtn').addEventListener('click', () => {
      const result = generateRandomAoMCiv();
      document.getElementById('result').innerHTML = `<h2>Selected Civilization: ${result.name}</h2><h3>Major God: ${result.god}</h3>`;
      document.getElementById('finalizeBtn').style.display = 'inline';
    });

    document.getElementById('finalizeBtn').addEventListener('click', () => {
      if (currentAoE4Civ) {
        finalizeAoE4Selection();
      } else if (currentAoMCiv) {
        finalizeAoMSelection();
      }
      document.getElementById('finalizeBtn').style.display = 'none';
      document.getElementById('weights').innerHTML = '';
    });

    // Call this function to create the weight inputs when the page loads
    updateWeightInputs();
  </script>
</body>

</html>
